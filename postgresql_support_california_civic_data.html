<!DOCTYPE html>
<html lang="en">
<head>
        <title>Setting up PostgreSQL Support for the California Civic Data Coalition</title>
        <meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="shortcut icon" href="static/favicon.ico" type="image/x-icon">
    <link rel="icon" href="static/favicon.ico" type="image/x-icon">
        <link rel="stylesheet" href="/theme/css/main.css" type="text/css" />

        <!--[if IE]>
                <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

        <!--[if lte IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="http://www.billchambers.me/css/ie.css"/>
                <script src="http://www.billchambers.me/js/IE8.js" type="text/javascript"></script><![endif]-->

        <!--[if lt IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="http://www.billchambers.me/css/ie6.css"/><![endif]-->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.min.js" type="text/javascript"></script>
<link href='http://www.billchambers.me/theme/Aaargh/Aaargh.ttf' rel='stylesheet' type='text/css'>


</head>

<body id="index" class="home">
<a href="https://www.github.com/anabranch">
<img style="position: absolute; top: 0; right: 0; border: 0;" src="http://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png" alt="Fork me on GitHub" />
</a>
	      <div class="l-detail"><p><img src="/static/anabranch.jpg" width="140" height="140" alt="Anabranching River"><br/>
            <a href="http://www.billchambers.me/index.html">Home</a><br/><a href="http://www.billchambers.me/about.html">About</a><br/><a href="http://www.billchambers.me/category/projects.html">Projects</a><br/><a href="http://www.billchambers.me/category/articles.html">Writings</a></p></div>
<section id="content" >
    <div class="body">
      <article>
        <header>
          <h1 class="entry-title">
            <a href="http://www.billchambers.me/postgresql_support_california_civic_data.html" rel="bookmark"
               title="Permalink to Setting up PostgreSQL Support for the California Civic Data Coalition">Setting up PostgreSQL Support for the California Civic Data Coalition</a></h1>

        </header>

        <div class="entry-content">
<div class="post-info">
	<ul>
        <li class="vcard author">
                 by&nbsp;<a class="url fn" href="http://www.billchambers.me/author/bill-chambers.html">Bill Chambers</a>
        </li>
        <li class="published" title="2014-11-09T00:00:00">
          on&nbsp;Sun 09 November 2014
        </li>

	</ul>
<p>Tags: <a href="http://www.billchambers.me/tag/oss.html">OSS</a>  <a href="http://www.billchambers.me/tag/open-source-software.html">Open Source Software</a>  <a href="http://www.billchambers.me/tag/civic-data.html">Civic Data</a>  <a href="http://www.billchambers.me/tag/postgresql.html">PostgreSQL</a>  </p></div><!-- /.post-info -->
<p><em>Over the past several months I've been contributing to the <a href="http://django-calaccess-raw-data.californiacivicdata.org/en/latest/">CalAccess Django Application for the California Civic Data Coalition</a>. I recently setup PostgreSQL support and detail the experience here.</em></p>          <h1>Background</h1>
<p>First, I'd like to introduce the <a href="http://www.californiacivicdata.org/">California Civic Data Coalition</a>. They are self described as a loosely coupled team from the Los Angeles Times Data Desk, The Center for Investigative Reporting and Stanford's Computational Journalism Lab. </p>
<p>I am not a part of the Los Angeles Times nor Stanford's computation Journalism Lab. However <strong>I am passionate about open data and leveraging my skills to help others.</strong> So I decided to start contributing. I started off with a rather small change then decided to sink my teeth into PostgreSQL support.</p>
<p>The aim of this document is to be a reference for others that may be challenged by similar feature development.</p>
<p>As a final thought I would encourage anyone and everyone to contribute to open data projects. I learned a lot setting up this feature and there is a lot of room for further contributions.</p>
<h2>Loading Textfile Data into MySQL vs PostgreSQL</h2>
<p>Typically <a href="https://www.djangoproject.com/">Django</a> has a pretty strong background for supporting multiple databases so I figured that supporting one or another would be trivial, especially coming from MySQL. I was wrong.</p>
<p>What you'll find below is a fairly detailed log of the changes that I made and why I wrote the code that I wrote. <a href="https://github.com/california-civic-data-coalition/django-calaccess-raw-data/blob/master/calaccess_raw/management/commands/loadcalaccessrawfile.py">Feel free to take a look at the code.</a></p>
<h3>First catch: LOAD DATA INFILE</h3>
<hr />
<p>We load our data using some fairly sophisticated Django management commands. Using MySQL's <a href="http://dev.mysql.com/doc/refman/5.1/en/load-data.html"><code>INFILE</code></a> support we bulk insert each file (while rearranging, cleaning, and renaming columns on the fly). Now PostgreSQL doesn't support <code>INFILE</code> loading but they've got a derivative: <a href="http://www.postgresql.org/docs/9.2/static/sql-copy.html"><code>COPY</code></a>.</p>
<p>Here's an example of a MySQL LOAD DATA INFO command.</p>
<div class="highlight"><pre><span class="k">LOAD</span> <span class="k">DATA</span> <span class="k">LOCAL</span> <span class="n">INFILE</span> <span class="s1">&#39;&lt;file name&gt;&#39;</span> <span class="k">INTO</span> <span class="k">TABLE</span> <span class="o">&lt;</span><span class="k">table</span><span class="o">&gt;</span>
<span class="p">(</span><span class="o">@</span><span class="n">var1</span><span class="p">)</span>
<span class="k">SET</span> <span class="nb">Date</span><span class="o">=</span><span class="n">str_to_date</span><span class="p">(</span><span class="n">SUBSTR</span><span class="p">(</span><span class="o">@</span><span class="n">var1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span><span class="s1">&#39;%m/%d/%Y&#39;</span><span class="p">),</span> 
<span class="n">Time</span><span class="o">=</span><span class="n">SUBSTR</span><span class="p">(</span><span class="o">@</span><span class="n">var1</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> 
<span class="n">WindVelocity</span><span class="o">=</span><span class="n">SUBSTR</span><span class="p">(</span><span class="o">@</span><span class="n">var1</span><span class="p">,</span><span class="mi">26</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span>
<span class="n">WindDirection</span><span class="o">=</span><span class="n">SUBSTR</span><span class="p">(</span><span class="o">@</span><span class="n">var1</span><span class="p">,</span><span class="mi">33</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span>
<span class="n">WindCompass</span><span class="o">=</span><span class="n">SUBSTR</span><span class="p">(</span><span class="o">@</span><span class="n">var1</span><span class="p">,</span><span class="mi">38</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span>
<span class="n">WindNorth</span><span class="o">=</span><span class="n">SUBSTR</span><span class="p">(</span><span class="o">@</span><span class="n">var1</span><span class="p">,</span><span class="mi">43</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span>
<span class="n">WindEast</span><span class="o">=</span><span class="n">SUBSTR</span><span class="p">(</span><span class="o">@</span><span class="n">var1</span><span class="p">,</span><span class="mi">51</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span>
<span class="n">WindSamples</span><span class="o">=</span><span class="n">SUBSTR</span><span class="p">(</span><span class="o">@</span><span class="n">var1</span><span class="p">,</span><span class="mi">61</span><span class="p">,</span><span class="mi">4</span><span class="p">);</span>
</pre></div>


<p>It's important to note all the <code>@var</code> fanciness. That's what makes this so easy(ish).</p>
<h5>Understanding PostgreSQL COPY</h5>
<p>The problem is that <code>COPY</code> in Postgres, from my interpretation, is meant for unloading to a text file then loading it back in without really performing any modifications. It doesn't have any of the dexterity shown above. Here's an example of a <a href="http://www.postgresql.org/docs/9.2/static/sql-copy.html"><code>COPY</code></a> command.</p>
<div class="highlight"><pre><span class="k">COPY</span> <span class="n">country</span> <span class="k">FROM</span> <span class="s1">&#39;/usr1/proj/bray/sql/country_data&#39;</span><span class="p">;</span>
</pre></div>


<p>Obviously, we're not just unloading data and loading it back in. We are transforming dates and substrings, not to mention we are moving data from a completely different system into Postgres. That's where things get tricky, I can't format data on the fly, renaming columns isn't going to work. I don't have nearly as many tools as MySQL does.</p>
<h3>First Attempt: Clean before Insert</h3>
<hr />
<p>So I figured I could write some little <a href="https://www.python.org/">python</a> script to clean the the data before inputting it. The problem is some of the files are huge (&gt; 1gb) so I could not do it with anything resembling speed. </p>
<p><strong>So this attempt failed miserably, it was just too slow.</strong></p>
<h3>Second Attempt: A Temporary Table</h3>
<hr />
<p>Things improved when I started creating a temporary table on the fly, inserting the data then applying transformations upon insert into the true table. Now there are a couple of tricks that I pulled off to be able to do this.</p>
<h3>First Catch: DateTimes &amp; Integers</h3>
<p>I had to use some special case statements in postgres to be able to coerce these types when taking them from the temporary table to our new table.</p>
<p>Now at this point. I'm feeling pretty good. I've got a couple of tables that are inserting without issue so I figure I'll move onto all the files.</p>
<h3>Second Catch: Empty Columns and Not Null Constraints</h3>
<p>The second catch was a bit more nuanced. Basically for certain tables, we added certain fields. I'm not quite sure <em>why</em> these fields have been added but they have. Unfortunately we can't just ignore them because, although they are set like </p>
<div class="highlight"><pre>    <span class="n">intr_adr1</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span>
        <span class="n">max_length</span><span class="o">=</span><span class="il">55L</span><span class="p">,</span> <span class="n">db_column</span><span class="o">=</span><span class="s">&#39;INTR_ADR1&#39;</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="bp">True</span>
    <span class="p">)</span>
</pre></div>


<p>Unfortunately that doesn't mean they call be set to nothing so we've got to handle that case as well.</p>
<h3>Third Catch: Boolean Fields</h3>
<p>The third catch was boolean fields. In our database they're stored as "Y"/"N". Now this shouldn't cause a problem however we insert them as integers in our database. This isn't really covered in the documentation so I was just getting errors where my inserts would fail.</p>
<p>Snooping around in my models showed me this code.</p>
<div class="highlight"><pre>    <span class="n">accept_limit_yn</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">(</span>
        <span class="n">db_column</span><span class="o">=</span><span class="s">&#39;ACCEPT_LIMIT_YN&#39;</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="bp">True</span>
    <span class="p">)</span>
</pre></div>


<p>That's clearly meant to be a yes/no field. So I had to modify my case statements to handle that. This is an example of accidental complexity - using the correct field type in our model could have allowed for a more graceful management of this information but instead we're adding another case statement to this insert.</p>
<div class="highlight"><pre>        <span class="p">,</span><span class="k">CASE</span>
            <span class="k">WHEN</span> <span class="ss">&quot;ACCEPT_LIMIT_YN&quot;</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                <span class="k">THEN</span> <span class="k">NULL</span>
            <span class="k">WHEN</span> <span class="ss">&quot;ACCEPT_LIMIT_YN&quot;</span> <span class="o">=</span> <span class="s1">&#39;Y&#39;</span>
                <span class="k">THEN</span> <span class="mi">1</span>
            <span class="k">WHEN</span> <span class="ss">&quot;ACCEPT_LIMIT_YN&quot;</span> <span class="o">=</span> <span class="s1">&#39;N&#39;</span>
                <span class="k">THEN</span> <span class="mi">0</span>
            <span class="k">WHEN</span> <span class="ss">&quot;ACCEPT_LIMIT_YN&quot;</span> <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span>
                <span class="k">THEN</span> <span class="ss">&quot;ACCEPT_LIMIT_YN&quot;</span><span class="p">::</span><span class="nb">int</span>
        <span class="k">END</span> <span class="k">AS</span> <span class="ss">&quot;ACCEPT_LIMIT_YN&quot;</span>
</pre></div>


<h3>Fourth Catch: Not being able to SELECT because of our modifications</h3>
<p>This was an interesting one: here's the SQL.</p>
<div class="highlight"><pre><span class="k">SELECT</span> <span class="ss">&quot;&quot;</span>

        <span class="p">,</span><span class="k">CASE</span>
            <span class="k">WHEN</span> <span class="ss">&quot;FILING_ID&quot;</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                <span class="k">THEN</span> <span class="k">NULL</span>
            <span class="k">WHEN</span> <span class="ss">&quot;FILING_ID&quot;</span> <span class="o">=</span> <span class="s1">&#39;Y&#39;</span>
                <span class="k">THEN</span> <span class="mi">1</span>
            <span class="k">WHEN</span> <span class="ss">&quot;FILING_ID&quot;</span> <span class="o">=</span> <span class="s1">&#39;N&#39;</span>
                <span class="k">THEN</span> <span class="mi">0</span>
            <span class="k">WHEN</span> <span class="ss">&quot;FILING_ID&quot;</span> <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span>
                <span class="k">THEN</span> <span class="ss">&quot;FILING_ID&quot;</span><span class="p">::</span><span class="nb">int</span>
        <span class="k">END</span> <span class="k">AS</span> <span class="ss">&quot;FILING_ID&quot;</span>

        <span class="p">,</span><span class="k">CASE</span>
            <span class="k">WHEN</span> <span class="ss">&quot;FILING_TYPE&quot;</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                <span class="k">THEN</span> <span class="k">NULL</span>
            <span class="k">WHEN</span> <span class="ss">&quot;FILING_TYPE&quot;</span> <span class="o">=</span> <span class="s1">&#39;Y&#39;</span>
                <span class="k">THEN</span> <span class="mi">1</span>
            <span class="k">WHEN</span> <span class="ss">&quot;FILING_TYPE&quot;</span> <span class="o">=</span> <span class="s1">&#39;N&#39;</span>
                <span class="k">THEN</span> <span class="mi">0</span>
            <span class="k">WHEN</span> <span class="ss">&quot;FILING_TYPE&quot;</span> <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span>
                <span class="k">THEN</span> <span class="ss">&quot;FILING_TYPE&quot;</span><span class="p">::</span><span class="nb">int</span>
        <span class="k">END</span> <span class="k">AS</span> <span class="ss">&quot;FILING_TYPE&quot;</span>
<span class="k">FROM</span> <span class="n">temporary_table</span><span class="p">;</span>
</pre></div>


<p>Now <code>SELECT ""</code> obviously isn't going to work. So I add a dummy column to the temporary table and the new table. I then remove it after the successful(or unsuccessful) insert.</p>
<h3>Fifth Catch: Incorrect Lengths</h3>
<p>MySQL using <code>LOAD DATA</code> seems to automatically truncate fields. This made things complicated for me because PostgreSQL did no such thing. I had to find which fields were causing the issues and resolve them.</p>
<p>When I would <code>grep</code> certain files I'd see that there were plenty of fields causing issues. This is a great example (more can be seen in the <a href="https://github.com/california-civic-data-coalition/django-calaccess-raw-data/issues/68">Github issue</a>.</p>
<p>The python code:</p>
<div class="highlight"><pre><span class="k">class</span> <span class="nc">FilernameCd</span><span class="p">(</span><span class="n">CalAccessBaseModel</span><span class="p">):</span>
    <span class="n">DATE_FIELDS</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;EFFECT_DT&#39;</span><span class="p">,)</span>
    <span class="n">xref_filer_id</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span>
        <span class="n">max_length</span><span class="o">=</span><span class="il">7L</span><span class="p">,</span>
        <span class="n">db_column</span><span class="o">=</span><span class="s">&#39;XREF_FILER_ID&#39;</span><span class="p">,</span>
        <span class="n">db_index</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
        <span class="n">help_text</span><span class="o">=</span><span class="s">&quot;The external filer id saved in the forms tables&quot;</span>
    <span class="p">)</span>
</pre></div>


<p>The relevant file:</p>
<div class="highlight"><pre><span class="nv">$ </span>head -1 filername_cd.csv
<span class="s2">&quot;XREF_FILER_ID&quot;</span>,<span class="s2">&quot;FILER_ID&quot;</span>,<span class="s2">&quot;FILER_TYPE&quot;</span>,<span class="s2">&quot;STATUS&quot;</span>,<span class="s2">&quot;EFFECT_DT&quot;</span>,<span class="s2">&quot;NAML&quot;</span>,<span class="s2">&quot;NAMF&quot;</span>,<span class="s2">&quot;NAMT&quot;</span>,<span class="s2">&quot;NAMS&quot;</span>,<span class="s2">&quot;ADR1&quot;</span>,<span class="s2">&quot;ADR2&quot;</span>,<span class="s2">&quot;CITY&quot;</span>,<span class="s2">&quot;ST&quot;</span>,<span class="s2">&quot;ZIP4&quot;</span>,<span class="s2">&quot;PHON&quot;</span>,<span class="s2">&quot;FAX&quot;</span>,<span class="s2">&quot;EMAIL&quot;</span>
<span class="nv">$ </span>grep -E <span class="s2">&quot;R98\*-\d+&quot;</span> filername_cd.csv | wc -l
     609
</pre></div>


<p>The grep data:</p>
<div class="highlight"><pre><span class="s2">&quot;XREF_FILER_ID&quot;</span>,....
<span class="s2">&quot;R98*-185420615&quot;</span>,....
</pre></div>


<p>Finally the same data in the MySQL db:</p>
<div class="highlight"><pre><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="n">XREF_FILER_ID</span> <span class="k">FROM</span> <span class="n">FILERNAME_CD</span> <span class="k">where</span> <span class="n">XREF_FILER_ID</span> <span class="k">like</span> <span class="s1">&#39;R98*-18%&#39;</span><span class="p">;</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span> <span class="n">XREF_FILER_ID</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="o">|</span> <span class="n">R98</span><span class="o">*-</span><span class="mi">18</span>       <span class="o">|</span>
<span class="o">|</span> <span class="n">R98</span><span class="o">*-</span><span class="mi">18</span>       <span class="o">|</span>
<span class="o">|</span> <span class="n">R98</span><span class="o">*-</span><span class="mi">18</span>       <span class="o">|</span>
<span class="p">....</span>
<span class="o">+</span><span class="c1">---------------+</span>
<span class="mi">29</span> <span class="k">rows</span> <span class="k">in</span> <span class="k">set</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span> <span class="n">sec</span><span class="p">)</span>
</pre></div>


<p>We can see there the data is getting truncated. It's unfortunate there was no warning that it was but I think that's still a response to how PostgreSQL and MySQL respond to data inserts.</p>
<h3>Sixth Catch: Incorrect Data (or data definitions)</h3>
<p>So I'm running some of my final tests, end-to-end and I stumble upon this one.</p>
<p>Here's where the issue occurs:</p>
<div class="highlight"><pre> Loading CvrRegistrationCd
dataerror error,  invalid input syntax <span class="k">for </span>integer: <span class="s2">&quot;01/0&quot;</span>
</pre></div>


<div class="highlight"><pre><span class="k">class</span> <span class="nc">CvrRegistrationCd</span><span class="p">(</span><span class="n">CalAccessBaseModel</span><span class="p">):</span>
<span class="o">...</span>
    <span class="n">ls_beg_yr</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">(</span>
        <span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">db_column</span><span class="o">=</span><span class="s">&#39;LS_BEG_YR&#39;</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="bp">True</span>
    <span class="p">)</span>
    <span class="n">ls_end_yr</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">(</span><span class="n">db_column</span><span class="o">=</span><span class="s">&#39;LS_END_YR&#39;</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span class="nv">$ </span>head -1 cvr_registration_cd.csv
<span class="s2">&quot;FILING_ID&quot;</span>...<span class="s2">&quot;RPT_DATE&quot;</span>,<span class="s2">&quot;LS_BEG_YR&quot;</span>,<span class="s2">&quot;LS_END_YR&quot;</span>....
<span class="nv">$ </span>grep <span class="s2">&quot;01/0&quot;</span> cvr_registration_cd.csv
<span class="s2">&quot;938431&quot;</span>...<span class="s2">&quot;6/7/2003 12:00:00 AM&quot;</span>,<span class="s2">&quot;01/0&quot;</span>,<span class="s2">&quot;12/3&quot;</span>...
</pre></div>


<p>It's one line in the file where the files should be integers but are instead <strong>"01/0","12/3"</strong></p>
<h2>Conclusions</h2>
<p>This took a serious amount of time to be able to complete in an appropriate way.  Handling these edge cases is an important thing to do and when you're doing it in a system that will be used by a lot of others you have to be confident in what you're doing.</p>
<p>Here's the process from a 10,000 foot view.
I create an empty table and insert all CSV data into that table. I then, through <code>INSERT INTO</code> and <code>SELECT</code> statements move that data from the temporary table into its true table. In this process I end up having to deal with a lot of unique cases not limited to integer fields being "Y/N", dates formatted in strange and inconsistent ways, and null constraints that are violated by the insert. These are all detailed in the methods like the one below.</p>
<div class="highlight"><pre><span class="k">def</span> <span class="nf">_make_XXXXXXX_case</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_col</span><span class="p">):</span>
    <span class="o">....</span>
</pre></div>


<p>I construct the insert and select statements differently as there are issues with column ordering, then attempt to insert - returning the errors with detailed reasoning. On my latest run, I experience no errors however I suspect that more will come up as data is added. In my last couple of pull requests we can see typical fields that cause these issues - I think this would be a great pull request/issue for someone new to Django.</p>
        </div><!-- /.entry-content -->

      </article>
    </div>
</section>
        <section id="extras" >
       
        
        </section><!-- /#extras -->
	
        <footer id="contentinfo" >
                <address id="about" class="vcard ">
                Proudly powered by <a href="http://getpelican.com/" target="_blank">Pelican</a>, which takes
                great advantage of <a href="http://python.org" target="_blank">Python</a>. &copy; <a class="url fn" href="http://www.billchambers.me">Bill Chambers</a>
		
                </address><!-- /#about -->
		

                
        </footer><!-- /#contentinfo -->

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-54337529-1', 'auto');
  ga('send', 'pageview');

</script>
</body>
</html>